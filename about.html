<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="shortcut icon" href="favicon.ico" type="image/x-icon">
    <title>–ü–µ—Å–Ω–∏</title>
    <link rel="stylesheet" href="CSS/index.css">
    <style>
        .about-section {
            background: white;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .about-section h2 {
            margin: 0 0 15px 0;
            color: #2c3e50;
            font-size: 1.3rem;
        }
        
        .project-title {
            font-size: 1.2rem;
            color: #2c3e50;
            margin-bottom: 10px;
            line-height: 1.5;
        }
        
        .project-meta {
            color: #666;
            font-size: 0.95rem;
            line-height: 1.8;
        }
        
        .contact-info {
            color: #333;
            line-height: 1.8;
        }
        
        .contact-email {
            color: #3498db;
            text-decoration: none;
            font-weight: 500;
        }
        
        .contact-email:hover {
            text-decoration: underline;
        }
        
        .changelog-content {
            background: #f8f9fa;
            border-left: 3px solid #3498db;
            padding: 15px;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            line-height: 1.6;
            white-space: pre-wrap;
            overflow-x: auto;
            max-height: 400px;
            overflow-y: auto;
        }
        
        .changelog-link {
            display: inline-block;
            margin-top: 10px;
            color: #3498db;
            text-decoration: none;
            font-size: 0.95rem;
        }
        
        .changelog-link:hover {
            text-decoration: underline;
        }
        
        .loading {
            color: #999;
            font-style: italic;
        }
        
        .error {
            color: #e74c3c;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- –ù–∞–≤–∏–≥–∞—Ü–∏—è (–±–µ–∑ –ø–æ–¥—Å–≤–µ—Ç–∫–∏) -->
        <div class="header-nav">
            <a href="index.html" class="header-cell">–ê–ë–í</a>
            <a href="index_full.html" class="header-cell">–í—Å–µ</a>
            <a href="topics.html" class="header-cell">–¢–µ–º—ã</a>
            <a href="books.html" class="header-cell">–ö–Ω–∏–≥–∏</a>
            <a href="today.html" class="header-cell">–°–µ–≥–æ–¥–Ω—è</a>
            <a href="search.html" class="header-cell">
                <img src="search.png" alt="–ü–æ–∏—Å–∫">
            </a>
        </div>
        
        <!-- –ë–ª–æ–∫ 1: –û –ø—Ä–æ–µ–∫—Ç–µ -->
        <div class="about-section">
            <div class="project-title">
                –ü–µ—Å–Ω–∏ –±—Ä–∞—Ç—Å—Ç–≤–∞ –ú–°–¶ —Å –Ω–æ—Ç–∞–º–∏ –¥–ª—è —Ñ–æ—Ä—Ç–µ–ø–∏–∞–Ω–æ
            </div>
            <div class="project-meta">
                <div id="update-date">–û–±–Ω–æ–≤–ª–µ–Ω–æ: –∑–∞–≥—Ä—É–∑–∫–∞...</div>
                <div id="statistics">–ó–∞–≥—Ä—É–∑–∫–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏...</div>
            </div>
        </div>
        
        <!-- –ë–ª–æ–∫ 2: –û–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å -->
        <div class="about-section">
            <h2>üìß –û–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å</h2>
            <div class="contact-info">
                –ù–∞—à–ª–∏ –æ—à–∏–±–∫—É –∏–ª–∏ –µ—Å—Ç—å –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ?<br>
                –ù–∞–ø–∏—à–∏—Ç–µ –Ω–∞: <a href="mailto:luchezavr@proton.me" class="contact-email">luchezavr@proton.me</a>
            </div>
        </div>
        
        <!-- –ë–ª–æ–∫ 3: –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π -->
        <div class="about-section">
            <h2>üìã –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π</h2>
            <div class="changelog-content" id="changelog">
                <span class="loading">–ó–∞–≥—Ä—É–∑–∫–∞ –∏—Å—Ç–æ—Ä–∏–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–π...</span>
            </div>
            <a href="changelog.txt" class="changelog-link" download>üìÑ –°–∫–∞—á–∞—Ç—å –ø–æ–ª–Ω—É—é –∏—Å—Ç–æ—Ä–∏—é</a>
        </div>
    </div>

    <script>
        // –ó–∞–≥—Ä—É–∑–∫–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
        async function loadStatistics() {
            try {
                const [songsResponse, booksResponse] = await Promise.all([
                    fetch('songs_all.json'),
                    fetch('books.json')
                ]);
                
                const songs = await songsResponse.json();
                const books = await booksResponse.json();
                
                // –ü–æ–¥—Å—á—ë—Ç —Å–±–æ—Ä–Ω–∏–∫–æ–≤ —Å –ø–µ—Å–Ω—è–º–∏
                const booksWithSongs = new Set();
                songs.forEach(song => {
                    if (song.book) {
                        booksWithSongs.add(song.book);
                    }
                });
                
                // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
                document.getElementById('statistics').textContent = 
                    `–í –∫–æ–ª–ª–µ–∫—Ü–∏–∏ ${songs.length} ${getPluralForm(songs.length, '–ø–µ—Å–Ω—è', '–ø–µ—Å–Ω–∏', '–ø–µ—Å–µ–Ω')}, ${booksWithSongs.size} ${getPluralForm(booksWithSongs.size, '—Å–±–æ—Ä–Ω–∏–∫', '—Å–±–æ—Ä–Ω–∏–∫–∞', '—Å–±–æ—Ä–Ω–∏–∫–æ–≤')}`;
                
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏:', error);
                document.getElementById('statistics').innerHTML = 
                    '<span class="error">–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏</span>';
            }
        }
        
        // –ó–∞–≥—Ä—É–∑–∫–∞ –∏—Å—Ç–æ—Ä–∏–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–π
        async function loadChangelog() {
            try {
                const response = await fetch('changelog.txt');
                if (!response.ok) {
                    throw new Error('–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å changelog.txt');
                }
                
                const text = await response.text();
                
                // –ë–µ—Ä—ë–º –ø–µ—Ä–≤—ã–µ 50 —Å—Ç—Ä–æ–∫
                const lines = text.split('\n');
                const first50Lines = lines.slice(0, 50).join('\n');
                
                document.getElementById('changelog').textContent = first50Lines || '–ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π –ø—É—Å—Ç–∞';
                
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ changelog:', error);
                document.getElementById('changelog').innerHTML = 
                    '<span class="error">–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é –∏–∑–º–µ–Ω–µ–Ω–∏–π</span>';
            }
        }
        
        // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –¥–∞—Ç—ã –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è (—Ç–µ–∫—É—â–∞—è –¥–∞—Ç–∞)
        function setUpdateDate() {
            const today = new Date();
            const monthNames = ["—è–Ω–≤–∞—Ä—è", "—Ñ–µ–≤—Ä–∞–ª—è", "–º–∞—Ä—Ç–∞", "–∞–ø—Ä–µ–ª—è", "–º–∞—è", "–∏—é–Ω—è", 
                                "–∏—é–ª—è", "–∞–≤–≥—É—Å—Ç–∞", "—Å–µ–Ω—Ç—è–±—Ä—è", "–æ–∫—Ç—è–±—Ä—è", "–Ω–æ—è–±—Ä—è", "–¥–µ–∫–∞–±—Ä—è"];
            
            document.getElementById('update-date').textContent = 
                `–û–±–Ω–æ–≤–ª–µ–Ω–æ: ${today.getDate()} ${monthNames[today.getMonth()]} ${today.getFullYear()}`;
        }
        
        // –°–∫–ª–æ–Ω–µ–Ω–∏–µ —Å–ª–æ–≤
        function getPluralForm(number, one, two, five) {
            let n = Math.abs(number);
            n %= 100;
            if (n >= 5 && n <= 20) {
                return five;
            }
            n %= 10;
            if (n === 1) {
                return one;
            }
            if (n >= 2 && n <= 4) {
                return two;
            }
            return five;
        }
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        document.addEventListener('DOMContentLoaded', function() {
            setUpdateDate();
            loadStatistics();
            loadChangelog();
        });
    </script>
</body>
</html>
